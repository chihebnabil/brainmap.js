<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brinmap.js - Interactive Library Example</title>
    <link rel="stylesheet" href="./brainmap.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
        }

        #mindmap-container {
            width: 100vw;
            height: 100vh;
        }

        .demo-controls {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .demo-controls h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: #374151;
        }

        .demo-btn {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .demo-btn:hover {
            background: #f3f4f6;
            transform: translateY(-1px);
        }

        .theme-selector {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .theme-selector select {
            padding: 5px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 12px;
        }
    </style>
</head>

<body>
    <div id="mindmap-container"></div>

    <div class="demo-controls">
        <h3>üß† Brinmap.js Demo</h3>

        <div class="theme-selector">
            <label for="theme-select">Theme:</label>
            <select id="theme-select">
                <option value="default">Default</option>
                <option value="dark">Dark</option>
                <option value="compact">Compact</option>
                <option value="professional">Professional</option>
                <option value="vibrant">Vibrant</option>
            </select>
        </div>

        <button class="demo-btn" onclick="loadSampleData()">üìä Load Sample Data</button>
        <button class="demo-btn" onclick="loadProjectData()">üíº Load Project Data</button>
        <button class="demo-btn" onclick="loadLearningData()">üìö Load Learning Data</button>
        <button class="demo-btn" onclick="toggleEditing()">‚úèÔ∏è Toggle Editing</button>
        <button class="demo-btn" onclick="addRandomNode()">‚ûï Add Random Node</button>
        <button class="demo-btn" onclick="testCustomColors()">üé® Test Custom Colors</button>
    </div>

    <script src="brainmap-config.js?v=2"></script>
    <script src="brainmap.js?v=2"></script>
    <script>
        // Initialize the mindmap
        let mindmap;
        let isEditable = true;

        // Sample datasets
        const sampleDatasets = {
            simple: {
                id: 'root',
                name: 'My Ideas',
                children: [
                    { id: 'idea1', name: 'Idea 1', children: [{ id: 'detail1', name: 'Detail A' }] },
                    { id: 'idea2', name: 'Idea 2' },
                    { id: 'idea3', name: 'Idea 3', children: [{ id: 'detail2', name: 'Detail B' }, { id: 'detail3', name: 'Detail C' }] }
                ]
            },

            project: {
                id: 'project-root',
                name: 'Web App Project',
                children: [
                    {
                        id: 'frontend',
                        name: 'Frontend',
                        children: [
                            { id: 'react', name: 'React Components' },
                            { id: 'styling', name: 'CSS/Styling' },
                            { id: 'routing', name: 'Routing' }
                        ]
                    },
                    {
                        id: 'backend',
                        name: 'Backend',
                        children: [
                            { id: 'api', name: 'REST API' },
                            { id: 'database', name: 'Database' },
                            { id: 'auth', name: 'Authentication' }
                        ]
                    },
                    {
                        id: 'deployment',
                        name: 'Deployment',
                        children: [
                            { id: 'hosting', name: 'Hosting' },
                            { id: 'cicd', name: 'CI/CD Pipeline' },
                            { id: 'monitoring', name: 'Monitoring' }
                        ]
                    },
                    { id: 'testing', name: 'Testing' }
                ]
            },

            learning: {
                id: 'learning-root',
                name: 'JavaScript Learning Path',
                children: [
                    {
                        id: 'basics',
                        name: 'Basics',
                        children: [
                            { id: 'variables', name: 'Variables & Types' },
                            { id: 'functions', name: 'Functions' },
                            { id: 'objects', name: 'Objects & Arrays' }
                        ]
                    },
                    {
                        id: 'intermediate',
                        name: 'Intermediate',
                        children: [
                            { id: 'async', name: 'Async/Await' },
                            { id: 'promises', name: 'Promises' },
                            { id: 'modules', name: 'ES6 Modules' },
                            { id: 'classes', name: 'Classes' }
                        ]
                    },
                    {
                        id: 'advanced',
                        name: 'Advanced',
                        children: [
                            { id: 'closures', name: 'Closures' },
                            { id: 'prototypes', name: 'Prototypes' },
                            { id: 'patterns', name: 'Design Patterns' }
                        ]
                    },
                    {
                        id: 'frameworks',
                        name: 'Frameworks',
                        children: [
                            { id: 'react-fw', name: 'React' },
                            { id: 'vue', name: 'Vue.js' },
                            { id: 'angular', name: 'Angular' },
                            { id: 'node', name: 'Node.js' }
                        ]
                    }
                ]
            }
        };

        // Initialize mindmap with default configuration
        function initMindMap() {
            mindmap = new MindMap('#mindmap-container', {
                width: 800,
                height: 800,
                editable: isEditable,
                showControls: true,
                showStatus: true,
                theme: 'default'
            });

            // Set initial data
            mindmap.setData(sampleDatasets.simple);
        }

        // Load different sample datasets
        function loadSampleData() {
            if (!mindmap) {
                console.warn('MindMap not initialized yet. Please wait...');
                return;
            }
            mindmap.setData(sampleDatasets.simple);
        }

        function loadProjectData() {
            if (!mindmap) {
                console.warn('MindMap not initialized yet. Please wait...');
                return;
            }
            mindmap.setData(sampleDatasets.project);
        }

        function loadLearningData() {
            if (!mindmap) {
                console.warn('MindMap not initialized yet. Please wait...');
                return;
            }
            mindmap.setData(sampleDatasets.learning);
        }

        // Toggle editing mode
        function toggleEditing() {
            if (!mindmap) {
                console.warn('MindMap not initialized yet. Please wait...');
                return;
            }
            isEditable = !isEditable;
            mindmap.updateConfig({ editable: isEditable });
        }

        // Add a random node to the root
        function addRandomNode() {
            if (!mindmap) {
                console.warn('MindMap not initialized yet. Please wait...');
                return;
            }
            if (!isEditable) {
                alert('Enable editing mode first!');
                return;
            }

            const randomNames = [
                'New Idea', 'Innovation', 'Strategy', 'Goal', 'Task',
                'Research', 'Development', 'Analysis', 'Planning', 'Review'
            ];
            const randomName = randomNames[Math.floor(Math.random() * randomNames.length)];

            const rootId = mindmap.getData().id;
            mindmap.addChild(rootId, randomName);
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function () {
            initMindMap();

            // Theme change handler
            document.getElementById('theme-select').addEventListener('change', function (e) {
                if (!mindmap) {
                    console.warn('MindMap not initialized yet. Please wait...');
                    return;
                }
                const selectedTheme = e.target.value;

                if (MindMapThemes[selectedTheme]) {
                    mindmap.updateConfig(MindMapThemes[selectedTheme]);
                } else {
                    mindmap.updateConfig({ theme: selectedTheme });
                }
            });

            // Demo automatic theme switching every 10 seconds (remove this for production)
            let themeIndex = 0;
            const themes = Object.keys(MindMapThemes);

            /* Uncomment to enable automatic theme cycling
            setInterval(() => {
                themeIndex = (themeIndex + 1) % themes.length;
                const themeName = themes[themeIndex];
                document.getElementById('theme-select').value = themeName;
                mindmap.updateConfig(MindMapThemes[themeName]);
            }, 10000);
            */
        });

        // Test custom colors
        function testCustomColors() {
            if (!document.getElementById('mindmap-container')) {
                console.warn('MindMap container not found. Please wait...');
                return;
            }
            // Create a new mindmap with custom colors
            mindmap = new MindMap(document.getElementById('mindmap-container'), {
                theme: 'default',
                colors: {
                    root: { fill: '#ff6b6b', stroke: '#e55656', text: '#ffffff' },
                    branch: { fill: '#4ecdc4', stroke: '#44b2aa', text: '#1a5b56' },
                    leaf: { fill: '#ffe66d', stroke: '#f5d547', text: '#8b6914' },
                    link: 'rgba(255,107,107,0.5)'
                },
                editable: isEditable,
                showControls: true,
                showStatus: true
            });

            // Set the data
            mindmap.setData(sampleDatasets.simple);
        }

        // Demonstrate programmatic API usage
        function demonstrateAPI() {
            console.log('=== MindMap.js API Demo ===');

            // Get current data
            console.log('Current data:', mindmap.getData());

            // Add nodes programmatically
            const rootId = mindmap.getData().id;
            mindmap.addChild(rootId, 'API Added Node');

            // You can also listen for data changes
            mindmap.updateConfig({
                onDataChange: (newData) => {
                    console.log('Data changed:', newData);
                },
                onNodeAdd: (parent, newNode) => {
                    console.log('Node added:', newNode.name, 'to', parent.name);
                }
            });
        }

        // Call this in browser console to see API in action
        window.demonstrateAPI = demonstrateAPI;
        window.mindmap = mindmap; // Make mindmap available in console for debugging
    </script>
</body>

</html>